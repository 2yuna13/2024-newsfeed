<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <title>Join Page</title>
    <!--favicon.ico-->
    <link rel="icon" href="data:;base64,=">
</head>

<body>
<h1> Join Page </h1>
<form>
    <!-- 이메일 입력 -->
    <input type="text" name="email" placeholder="email" id="new-user-email">
    <br />
    <!-- 닉네임 입력 -->
    <input type="text" name="nickname" placeholder="nickname" id="new-user-nickname">
    <br />
    <!-- 비밀번호 입력 -->
    <input type="password" name="password" placeholder="password" id="new-user-password">
    <br />
    <button type="button" id="signup-btn">회원가입</button>
</form>
<a href="/login-page">로그인</a>

<Script>
    {
        // 회원가입 버튼 변수화
        const SignupBtn = document.querySelector("#signup-btn");

        // 회원가입 클릭 이벤트 감지!
        SignupBtn.addEventListener("click", function () {
            // 사용자 객체 생성
            const user = {
                email: document.querySelector("#new-user-email").value,
                nickname: document.querySelector("#new-user-nickname").value,
                password: document.querySelector("#new-user-password").value
            };

            console.log(user);

            // fetch() - 비동기 통신을 위한 API
            const url = "/api/auth/signup";
            fetch(url, {
                method: "post",
                body: JSON.stringify(user),
                headers: {
                    "Content-Type": "application/json"
                }
            }).then(response => {
                if (response.ok) {
                    alert("회원가입이 완료되었습니다.");
                    window.location.reload();
                } else {
                    // 실패한 경우 JSON 데이터 읽기
                    response.json().then(errorData => {
                        // 에러 메시지 출력 또는 처리
                        alert(`회원가입 실패: ${errorData.message}`);
                    });
                }
            });
        });
    }
</script>
</body>

</html>